---
title: "Homework_1"
author: "Toni Zarzosa and Berta Torrents"
output:
  pdf_document:
    toc: true
    toc_depth: 3
    number_sections: true
  word_document:
    toc: true
    toc_depth: '3'
    number_sections: true
  html_document:
    toc: true
    toc_depth: '3'
    df_print: paged
fontsize: 10pt
editor_options:
  chunk_output_type: console
---

# Clear directory and import libraries
```{r}
options(contrasts=c("contr.treatment","contr.treatment"))

if(!is.null(dev.list())) dev.off()
rm(list = ls())

library(readxl)
library(corrplot)
library(FactoMineR)
library(cluster)
library(ggplot2)
```

# Exploratory data analysis

## Import the data set to R correctly and assign player names as rownames of the data frame

The dataset has been imported with the *read_excel()* function from the *readxl* library. Using the *as.data.frame()* function, it has been converted to a data frame. 

The row names of the data frame have been assigned as the players' names. Moreover, the column containing the players' names has been removed from the data frame since it is no longer needed after being set as row names.
```{r}
df <- read_excel("data_Eurobasket_2025.xlsx")

df <- as.data.frame(df)

rownames(df) <- df$PLAYER

df <- df[,-1] # remove player column after setting it as a rowname
```

## Check the structure of the data and assign correct type to each variable considering whether it is a categorical or numerical variable

The *summary()* function reveals that this data frame has 17 numeric variables called “GP”, “MIN”, “FG”, “2PT.FG”, “3PT.FG”, “FT”, “OREB”, “DREB”, “REB”, “AST”, “PF”, “TO”, “STL”, “BLK”,  “+/-” , “EFF” and “PTS”. In addition, there are two categorical variables called “Team” and “Position”, which should be transformed into factors.

After assigning the correct type to each variable, the str function confirms that the structure of the data frame is properly defined.
```{r}
summary(df)

df$Team <- as.factor(df$Team)

df$Position <- as.factor(df$Position)

str(df)
```


## Create data frame only using variables “Position”, “MIN”, “FG”, “2PT.FG”, “3PT.FG”, “FT”, “OREB”, “DREB”, “REB”, “AST”, “PF”, “TO”, “STL”, “BLK”, “EFF” and “PTS”. Check the correlations between numerical variables and summarize your findings

A new data frame has been created based on the requested variables.

Moreover, the correlation matrix of the numeric variables in the new data frame has been computed. To visualize the correlation results, the *corrplot()* function from the *corrplot* library has been used.

The vast majority of numerical variables are positively correlated. In fact, those that are negatively correlated do not show a strong relationship. The highest negative correlation is between 2PT.FG and 3PT.FG, with value of $-0.311$. A player who takes a lot of 3-point shots may take fewer shots near the basket, and vice versa, but this trade-off is not extreme.

Nonetheless, there are some particular interesting positive correlations. To analyze these results more effectively, we will divide the study into three groups:

1) Very strong correlated variables (correlation > |0.90|):
- EFF and PTS (r = 0.95): Efficiency and points are almost perfectly correlated. These suggests that the more points a player scores, the more efficient is the player.

- DREB and REB (r = 0.97): Total rebounds is the sum of offensive rebounds and defensive rebounds. Nonetheless, it makes sense that defensive rebounds dominate total rebounds, since defensive rebounds are typically more frequent than offensive rebounds.

- EFF and DREB (r = 0.90): Players who grab defensive rebounds tend to have higher efficiency ratings.

2) Strong correlated variables (|0.90| > correlation > |0.80|):
- EFF and MIN (r = 0.83), MIN and PTS (r = 0.84): The more minutes a player spends on the court, the more points they tend to score, and, consequently, the higher their efficiency.

- OREB and REB (r = 0.87): Obviously, the total rebounds are correlated with offensive rebounds, since it contributes directly to the total number of rebounds.

- EFF and REB (r = 0.899): Usually, the more rebounds a player catches, the more efficient a player is.

- DREB and PTS (r = 0.817): The more defensive rebounds a player collects, the higher the probability of scoring, since each rebound creates an additional offensive opportunity, and therefore, more points can be scored.

3) Moderate correlated variables (|0.80| > correlation > |0.65|):

- AST and EFF (r = 0.666), EFF and TO (r = 0.761), AST and TO (r = 0.772): Efficiency is partly determined by assists and turnovers, so it makes sense that these variables are correlated. What is surprising, however, is that the correlation between efficiency and turnovers is positive, since a higher number of turnovers would normally be expected to reduce a player’s efficiency. On the other hand, the more assists a player makes, the more frequently they handle the ball, which naturally increases the likelihood of committing a turnover.

- EFF and OREB (r = 0.717): Efficiency is partly determined by offensive rebounds, so it makes sense that these variables are correlated.

- MIN - REB (r = 0.666), DREB - MIN (r = 0.731), AST - MIN (r = 0.707), MIN - TO (r = 0.663): The more minutes a player spends on the court, the more rebounds, assists, and turnovers they can make.

- 2PT FG - FG (r = 0.780): Usually, players who tend to score more two-point shots will have a higher overall field goal percentage. Notice that FG and 3PT.FG are negatively correlated, since three-point shots are generally more difficult to make and therefore lower the overall field goal percentage.

- DREB and OREB (r = 0.728): If a player is good at grabbing offensive rebounds, they are likely to be good at grabbing defensive rebounds as well.

- DREB - TO (r = 0.666): If a player grabs a defensive rebound, they immediately transition to offense, which increases the chances of losing the ball.

- PTS and TO (r = 0.761), PTS and REB (r = 0.788): The more points a player scores, the more frequently they handle the ball, which increases their probability of losing it. Similarly, the more rebounds a player collects, the higher their chances of scoring.

To summarize the previous ideas, it is clear that a player’s efficiency, the number of points they score, the minutes they spend on the court, and the rebounds they collect are highly correlated. It is also important to note that the MIN variable shows a moderate to strong correlation with almost all numerical variables. This makes complete sense, as the more time a player spends on the court, the higher all their recorded statistics are likely to be. Moreover, since the EFF variable is derived from individual performance indicators, it is expected to be correlated with them. However, because not all statistics contribute equally to a player’s efficiency, the strength of these correlations varies across variables.

```{r}
requested_var <- c("Position", "MIN", "FG", "2PT FG", "3PT FG", "FT", "OREB", "DREB", "REB", "AST", "PF", "TO", "STL", "BLK", "EFF", "PTS")

df_subset <- df[,requested_var]

cor_matrix <- cor(df_subset[,-1])

corrplot(cor_matrix, method = "number", tl.col = "black", title = "Correlation Matrix of Basketball Statistics")
```


# Application of PCA

## Apply PCA on the created data frame by using PCA() function in FactoMineR package and taking the variables “Position” and and “EEF” as supplementary variables

The *PCA()* function from the library *FactoMineR* has been applied to the *df_subset* taking the Position as a supplementary qualitative variable and the EFF as supplementary quantitative variable.

```{r}
eff_idx <- which(colnames(df_subset) == "EFF")
pos_idx <- which(colnames(df_subset) == "Position")

res.pca <- PCA(df_subset,
           scale.unit = TRUE,
           quali.sup  = pos_idx,
           quanti.sup = eff_idx,
           graph = FALSE)
```


## How many components should be extracted? Decide on the number of components considering eigenvalues

In order to determine the number of components to extract, the eigenvalues play a key role. Each eigenvalue represents the amount of variance explained by its corresponding principal component. Therefore, the higher the eigenvalue, the greater the proportion of total variability accounted for by that dimension.

Since the data is standardized, it makes sense to apply the Kaiser criterion, which retains components with eigenvalues greater than 1. In this case, the first three components (with eigenvalues $6.25$, $2.76$, and $1.25$) meet this requirement. Moreover, the cumulative percentage of variance shows that these three components explain $73.26\%$ of the total variance, which indicates that they capture most of the information in the data frame.

The scree plot shows a noticeable elbow after the second component, indicating that retaining three components captures most of the variance while keeping the solution interpretable.

Looking at the variable–dimension correlations, the choice of components makes sense.

- Dimension $1$ shows strong positive correlations with MIN, DREB, REB, PTS, TO, and other performance variables, reflecting overall playing time and productivity.

- Dimension $2$ is mainly associated with FG, 2PT FG, and BLK, contrasting with 3PT FG, representing an interior–exterior playing style axis.

- Dimension $3$ is moderately linked to 3PT FG and FT, capturing differences between shooting efficiency and playmaking. Note that these variables were already partially reflected in the first two dimensions.

Together, these three dimensions summarize the main sources of variability in the
data, balancing completeness and interpretability.

```{r}
res.pca$eig

barplot(res.pca$eig[,1], names.arg = 1:14, main = "Scree Plot", xlab = "Dimension", ylab = "Eigenvalue", col = "blue")
lines(res.pca$eig[,1], type = "o", col = "red", pch = 19)

res.pca$var$coord
corrplot(res.pca$var$coord)
```

## Interpret variable plots. How can each dimension be named? Use plot.PCA() function to show correlations between variables and the extracted dimensions. (For the variables you should use the argument choix = “var”). Plot all the extracted dimensions changing argument “axes”.

- Dimension $1$: Overall performance and productivity axis
Dimension $1$ shows strong positive loadings for variables related to overall workload and productivity. More specifically, DREB $(\sim 0.92)$, PTS $(\sim 0.92)$, REB $(\sim 0.91)$, MIN $(\sim 0.87)$, TO $(\sim 0.79)$, OREB $(\sim 0.73)$, STL $(\sim 0.64)$, and AST $(\sim 0.68)$ contribute most to this dimension.

Variables with near-zero or smaller loadings on Dimension $1$ are mainly related to shooting efficiency. FG, 2PT FG, 3PT FG, and FT contribute less to this dimension.

Hence, this axis can be interpreted as an overall workload/impact direction. In other words, dimension $1$ is associated with players who spend more minutes on the court, grab many rebounds, score a lot of points, and commit more turnovers. On the other hand, players with lower dimension $1$ coordinates are those with lower usage or with more limited roles on the team.

The supplementary quantitative variable EFF aligns strongly positively with dimension $1$. This is expected, as efficiency indices are constructed based on overall workload and productivity.

- Dimension $2$: Interior vs perimeter playing style axis
Dimension $2$ shows strong positive loadings for variables related to actions closer to the basket. More specifically, FG $(\sim 0.80)$ and 2PT FG $(\sim 0.79)$. It also has slightly positive loadings for other near-basket actions, such as BLK $(\sim 0.64)$ and OREB $(\sim 0.42)$.

On the other hand, it is negatively associated with variables related to actions farther from the basket, such as shooting threes 3PT FG $(\sim −0.60)$, taking free throws FT $(\sim −0.32)$, or creating plays for a teammate to score AST $(\sim−0.45)$.

Hence, this axis can be interpreted as a contrast between the interior and perimeter profiles. In other words, dimension $2$ is positively associated with players who are efficient at taking 2PT field goals and who have strong interior presence, such as blocking shots and grabbing offensive rebounds. Conversely, it is negatively associated with players who tend to play farther from the basket and perform more actions such as 3PT field goals, free throws, and assists. It’s interesting because players of this profile tend not to be the best shooters and is common to see them missing free throws.

- Dimension 3: Workload vs shooting precision axis
As expected, Dimension $3$ does not show strong loadings on any single variable. It could be said that it is slightly positively related to statistics associated with players who are more involved in the game, performing tasks such as handling the ball, making assists, grabbing rebounds, and committing turnovers. Indeed, it has slightly positive loadings for TO $(\sim 0.30)$, AST $(\sim 0.25)$, OREB $(\sim 0.24)$, and REB $(\sim 0.21)$.

On the other hand, it is negatively associated with players who are more focused on shooting efficiency. In fact, it has negative loadings for FT $(\sim −0.58)$, 3PT FG $(\sim −0.57)$, FG $(\sim −0.39)$, PF $(\sim −0.33)$, and 2PT FG $(\sim −0.24)$.

We could say that, similar to Dimension $2$, this dimension is related to the supplementary variable position, since a player’s position is key in determining their responsibilities on the court.

```{r}
plot.PCA(res.pca, choix = "var", axes = c(1, 2))
plot.PCA(res.pca, choix = "var", axes = c(1, 3))
plot.PCA(res.pca, choix = "var", axes = c(2, 3))
```


## Show individual plots for the extracted dimensions changing argument choix=“ind” in plot.PCA() function. Interpret the individual plots.

- Dimension $1$ vs Dimension $2$

Players on the right side of the first dimension axis, such as, Giannis Antetokounmpo, Alperen Sengun, Lauri Markkanen, Franz Wagner and Daniel Theis post high PTS, DREB, MIN, AST, and STL. Moreover, they also stand out in the efficiency statistic (EFF). Among them, Giannis Antetokounmpo, Alperen Sengun and Lauri Markkanen are extreme on OREB, REB, DREB, EFF, PTS, TO, STL, MIN, BLK, and AST, demonstrating a massive all-around impact.

On the left side of first dimension aixs, there are players such as Sertac Sanli, Leon Kratzer, Ilari Seppala, Onuralp Bitim and Andre Gustavson. These plaers have either low overall stats (Seppala and Bitim have low 2PT.FG, FG, REB, EFF, BLK, PTS and TO) or narrow interior roles (Sanli has high 2PT.FG and FG but low 3PT.FG, MIN, AST, FT, PTS, STL, EFF and TO).

Since EFF correlates strongly with dimension $1$ $(\sim 0.96)$, those players with high productivity will be on the right and those with low productivity on the left.

On the top side of the graphic, there are players such as Kostas Antetokounmpo, Adem Bona, Omer Faruk Yurtseven, Erkan Yilmaz, and Sertac Sanli, who stand out with high 2PT FG and FG, and lower 3PT FG, AST, and FT. Kostas Antetokounmpo is the player who stands out the most in this dimension, meaning he is the player with the most efficiency plays close to the basket.

Finally, the bottom side of the graphic includes players such as Shane Larkin, Dennis Schröder, Tyler Dorsey, Kostas Sloukas, and Furkan Korkmaz, who have lower 2PT FG and FG and higher 3PT FG, AST, and FT, highlighting those who perform more plays on the perimeter.

If we look at the supplementary variable position, we can clearly see how dimension $2$ separates players by their roles: center, forward, and guard. This makes perfect sense, since depending on their position, a player will tend to stand out more in activities close to the basket or in those taking place in more external areas. Naturally, this dimension places centers in the upper area (since they play closer to the basket) and guards more towards the middle of the court.

Players accumulated near the center of the graphic represent the average players. In other words, these are players who do not particularly stand out in terms of efficiency or in performing plays either near the basket or on the perimeter. 


- Dimension $1$ vs Dimension $3$

If we look at the horizontal axis of the graphic, we see that the players on the left and right sides are the same as in the previous graph.

The vertical axis of the graphic is particularly interesting. On the top side, players such as Daniel Theis, Johannes Thiemann, and Tristan Da Silva show high AST and OREB values, reflecting greater all-around involvement and playmaking activity. These individuals act as creators and high-involvement players who generate plays and second-chance opportunities but accept a higher turnover risk.

Notice that the vast majority of players are clustered on the top side of the graphic. This makes sense, as most players generally have the role of facilitating plays and passing the ball, while there are fewer players who stand out solely as strong shooters.

However, there are certain players, such as Giannis Antetokounmpo, Alperen Şengün, and Andre Gustafson, who exhibit lower AST but higher efficiency metrics, such as FT, 3PT FG, and FG. This indicates more disciplined and efficient profiles that contribute through clean scoring with fewer mistakes.


- Dimension $2$ vs Dimension $3$

The players who stand out in each dimension are the same as in the previous graphs. It is important to highlight the cluster of players that appears in the second quadrant. This is completely normal, since most players tend to combine a perimeter-oriented playing style (low on Dimension $2$) with high involvement and playmaking activity (high on Dimension $3$), reflecting their contribution through assists, ball handling, and overall participation in offensive actions rather than plays near the basket.

```{r}
# Color individuals by Position for interpretation (habillage = col index of the qualitative sup variable)
plot.PCA(res.pca, choix = "ind", axes = c(1, 2), habillage = 1)
plot.PCA(res.pca, choix = "ind", axes = c(1, 3), habillage = 1)
plot.PCA(res.pca, choix = "ind", axes = c(2, 3), habillage = 1)
```


# Application of MDS

## Apply metric MDS using Euclidean distance on scaled numerical variables. Plot the data using the points on the first two coordinates using players names as label. Interpret the plot.

The Euclidean distance matrix, based on the scaled numerical variables, has been computed using the *dist()* function. Using this matrix, the *cmdscale* function has been applied. 

The number of dimensions selected was $k=2$ (as required by the exercise). Taking into account the scree plot, it shows a noticeable elbow after the first component, indicating that retaining two dimensions captures most of the variance while keeping the solution interpretable. Moreover, the GOF obtained for the two-dimensional solution is $66.4%$, indicating that the map preserves a substantial proportion of the original distance information and provides a reasonably good representation of the relationships among the observations.

The MDS individual plot groups together players with similar statistical profiles. In other words, the more similar two players are in their statistics, the closer they appear in the map.

Two main clusters of players can be observed, reflecting groups of individuals with comparable performance patterns. Some players, such as Giannis Antetokounmpo, Alperen Sengun, and Lauri Markkanen, clearly stand out along the first dimension, showing distinctive all-around statistical profiles. In contrast, Kostas Antetokounmpo stands out along the second dimension, indicating a unique performance pattern relative to the rest.

Taking into account the PCA results, it can be observed that the outstanding players identified in the MDS are, in fact, those with higher coordinates in PCA Dimensions $1$ and $2$, respectively. Hence, the first MDS coordinate appears to correspond to the first PCA dimension, while the second MDS coordinate relates to the second PCA dimension. It is also important to note that a rotation should be applied in order to obtain the same orientation and interpretation as in PCA, since the first PCA dimension was highly correlated with players exhibiting higher overall performance and productivity, such as Giannis Antetokounmpo, Alperen Sengun or Lauri Markkanen, whereas in the MDS map, these players are positioned on the left side of the first dimension. Similarly, a rotation along the Y-axis would be required to align the second MDS coordinate with the PCA second dimension, ensuring consistent interpretation across both analyses.

```{r}
ds_eu <- dist(scale(df_subset[,-1]), method = "euclidean")

res.mds.eu <- cmdscale(ds_eu, eig = TRUE, k = 2)

res.mds.eu$GOF
res.mds.eu$eig

plot(1:length(res.mds.eu$eig), res.mds.eu$eig, 
     type = "b",
     xlab = "Dimension", 
     ylab = "Eigenvalue",
     main = "Scree Plot")


x <- res.mds.eu$points[,1]
y <- res.mds.eu$points[,2]
plot(x, y, xlab="Coordinate 1", ylab="Coordinate 2",
     main="Individual plot using the first two coordinates with Euclidian distance", type="n")
text(x, y, labels = row.names(df_subset), cex=.7)


# Rotation to align with the PCA
rot_mat <- matrix(c(-1, 0, 0, -1), nrow = 2, byrow = TRUE)
eu_rot <- res.mds.eu$points %*% rot_mat

x <- eu_rot[,1]
y <- eu_rot[,2]
plot(x, y, xlab="Coordinate 1", ylab="Coordinate 2",
     main="Individual plot using the first two coordinates with rotation and Euclidian distance", type="n")
text(x, y, labels = row.names(df_subset), cex=.7)
```


## Calculate gower distance including variable “POSITION” to the data matrix. Then apply metric MDS on gower distance matrix.

The gower distance including the position variable has been computed using the *daisy* function from the library *cluster*. Using this matrix, the *cmdscale* function has been applied.

The number of dimensions selected was $k=2$ (as required by the exercise). Taking into account the scree plot, it shows a noticeable elbow after the first component, indicating that retaining two dimensions captures most of the variance while keeping the solution interpretable. 

It is important to notice that, in the Euclidean distance case, both GOF values were identical. However, when using the gower distance, the two GOF components differ slightly. The first value $(0.56)$ measures the proportion of total variance explained by the two dimensions, considering both positive and negative eigenvalues, whereas the second value $(0.65)$ only takes into account the positive eigenvalues. This difference arises because the Gower distance combines mixed variable types.

This slightly lower value is expected when using the gower distance, as it handles mixed data types and does not produce a perfectly Euclidean distance matrix, which typically leads to a less accurate but still meaningful low-dimensional representation of the relationships among the observations.

```{r}
ds_gw <- daisy(df_subset, metric = "gower")

res.mds.gw <- cmdscale(ds_gw, eig = TRUE, k = 2)

res.mds.gw$GOF
res.mds.gw$eig

plot(1:length(res.mds.gw$eig), res.mds.gw$eig, 
     type = "b",
     xlab = "Dimension", 
     ylab = "Eigenvalue",
     main = "Scree Plot")

```


## Plot individual plots on the first two coordinates. Use different categorical and numerical variables as labels so as to explain clusters that are constructed.

After plotting the individual map for the Gower distance, and following the same reasoning as for the Euclidean distance, a $90°$ rotation of the x-axis was applied to maintain a consistent interpretation of the coordinates across analyses.

```{r}
x <- res.mds.gw$points[,1]
y <- res.mds.gw$points[,2]
plot(x, y, xlab="Coordinate 1", ylab="Coordinate 2",
     main="Individual plot using the first two coordinates with Gower distance", type="n")
text(x, y, labels = row.names(df_subset), cex=.7)


# Rotation to align with the PCA
rot_mat <- matrix(c(-1, 0, 0, 1), nrow = 2, byrow = TRUE)
gw_rot <- res.mds.gw$points %*% rot_mat

x <- gw_rot[,1]
y <- gw_rot[,2]
plot(x, y, xlab="Coordinate 1", ylab="Coordinate 2",
     main="Individual plot using the first two coordinates with rotation and Gower distance", type="n")
text(x, y, labels = row.names(df_subset), cex=.7)
```

The individual plots on the first two coordinates using different categorical and numerical variables as labels have been plotted using the *ggplot* function from library *ggplot2*. Two data frames were created to store the coordinates obtained from the MDS results together with the players’ information and their corresponding statistics, allowing for flexible visualization and interpretation of the results.

The variables selected to interpret the MDS representation were chosen to capture both overall player performance and playing style characteristics, as these were the two main dimensions revealed by the PCA. Specifically, EFF, PTS, and MIN describe player productivity, scoring output, and participation volume, respectively, providing a comprehensive view of overall effectiveness. Meanwhile, 2PT FG and 3PT FG were included to represent contrasting playing styles. Together, these variables summarize the most relevant aspects of player performance and behavior on the court, and align consistently with the main patterns previously observed in the PCA and MDS analyses.

```{r}
# Euclidian df
mds_eu_coords <- as.data.frame(eu_rot)
colnames(mds_eu_coords) <- c("Dim1", "Dim2")
mds_eu_coords$Player <- rownames(df_subset)
mds_eu_coords$Position <- df_subset$Position
mds_eu_coords$EFF <- df_subset$EFF
mds_eu_coords$PTS <- df_subset$PTS
mds_eu_coords$MIN <- df_subset$MIN
mds_eu_coords$`3PT FG` <- df_subset$`3PT FG`
mds_eu_coords$`2PT FG` <- df_subset$`2PT FG`

# Gower df
mds_gw_coords <- as.data.frame(gw_rot)
colnames(mds_gw_coords) <- c("Dim1", "Dim2")
mds_gw_coords$Player <- rownames(df_subset)
mds_gw_coords$Position <- df_subset$Position
mds_gw_coords$EFF <- df_subset$EFF
mds_gw_coords$PTS <- df_subset$PTS
mds_gw_coords$MIN <- df_subset$MIN
mds_gw_coords$`3PT FG` <- df_subset$`3PT FG`
mds_gw_coords$`2PT FG` <- df_subset$`2PT FG`
```

When the Position variable is included in the analysis, the MDS map based on the Gower distance clearly shows a better clustering of players according to their playing position (guards, forwards, and centers form clear clusters). This result is entirely expected, since the Euclidean-distance MDS does not account for the categorical Position variable, whereas the Gower-distance MDS explicitly incorporates it, allowing players with similar roles on the court to be grouped more accurately.

It is worth noting that Ercan Osmani and Erkan Yilmaz are exceptions to the position-based clustering in the Gower-distance map. Although classified as a center and a forward, respectively, Osmani is positioned closer to the forwards cluster, while Yilmaz is closer to the centers cluster.

```{r}
ggplot(mds_eu_coords, aes(x = Dim1, y = Dim2, color = Position, label = Player)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  labs(title = "MDS (Euclidean distance): Player Position",
       x = "Coordinate 1", y = "Coordinate 2", color = "Position") +
  theme_minimal()

ggplot(mds_gw_coords, aes(x = Dim1, y = Dim2, color = Position, label = Player)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  labs(title = "MDS (Gower distance): Player Position",
       x = "Coordinate 1", y = "Coordinate 2", color = "Position") +
  theme_minimal()
```

Regarding the Efficiency variable, both MDS plots show a very similar pattern. Outstanding players, such as Giannis Antetokounmpo, Alperen Sengun, and Lauri Markkanen, are clearly separated from the rest in both maps. It is true that the Euclidean-distance map tends to cluster players with lower efficiency together, whereas the Gower-distance map does not form such a distinct cluster for low-efficiency players. Nevertheless, groups of players according to their efficiency can still be clearly distinguished in both representations.

Notice that both plots display a green gradient (from light to dark) along the x-axis. This perfectly aligns with the relationship observed between the first coordinate in the PCA and MCA analyses.

```{r}
ggplot(mds_eu_coords, aes(x = Dim1, y = Dim2, color = EFF, label = Player)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  scale_color_gradient(low = "lightgreen", high = "darkgreen") +
  labs(title = "MDS (Euclidean distance): Efficiency (EFF)",
       x = "Coordinate 1", y = "Coordinate 2", color = "EFF") +
  theme_minimal()

ggplot(mds_gw_coords, aes(x = Dim1, y = Dim2, color = EFF, label = Player)) +
  geom_point(size = 3, alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  scale_color_gradient(low = "lightgreen", high = "darkgreen") +
  labs(title = "MDS (Gower distance): Efficiency (EFF)",
       x = "Coordinate 1", y = "Coordinate 2", color = "EFF") +
  theme_minimal()
```

Similar to the case of efficiency, both plots display a color gradient from pink to red along the x-axis, ordering players from lower to higher scorers. Point sizes also reflect playing time: smaller points correspond to players who play fewer minutes, while larger points indicate those with more minutes.

Considering that the first coordinate seems to capture overall player performance, these patterns are consistent: players on the right side of the plots are among the most active and productive on the court, while those on the left contribute fewer minutes and points. Overall, both visualizations effectively cluster players according to their minutes played and scoring output.

```{r}
ggplot(mds_eu_coords, aes(x = Dim1, y = Dim2, color = PTS, size = MIN, label = Player)) +
  geom_point(alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  scale_color_gradient(low = "lightpink", high = "red") +
  labs(title = "MDS (Euclidean distance): PTS (color) and MIN (size)",
       x = "Coordinate 1", y = "Coordinate 2", color = "PTS", size = "MIN") +
  theme_minimal()

ggplot(mds_gw_coords, aes(x = Dim1, y = Dim2, color = PTS, size = MIN, label = Player)) +
    geom_point(alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  scale_color_gradient(low = "lightpink", high = "red") +
  labs(title = "MDS (Gower distance): PTS (color) and MIN (size)",
       x = "Coordinate 1", y = "Coordinate 2", color = "PTS", size = "MIN") +
  theme_minimal()
```

The map using the Euclidean distance clearly separates players who make more 3PT shots from those who make fewer. Players positioned higher along the second dimension make fewer 3PT shots than those lower on this axis. A special mention goes to Sertac Sanli, who does not appear correctly within the 3PT. Although he is grouped with players who tend to miss threes, his point size is relatively large, indicating that he actually makes a significant number of 3PT shots, placing him outside the general pattern of the cluster. Regarding 2PT shots, the vertical axis shows a clear color gradient from dark blue to light blue. At the top of the plot are the players who make the most 2PT shots, while at the bottom are those who make the fewest. This pattern reinforces the idea that the second dimension reflects players’ efficiency in shooting.

On the other hand, the map using the Gower distance shows a similar clustering to the Euclidean map regarding 3PT shooting. However, when looking at the 2PT shots, although it still separates the players who make more from those who make fewer, Johannes Voigtmann is incorrectly positioned, as he usually misses 2-point shots but appears near the middle of the second coordinate.

```{r}
ggplot(mds_eu_coords, aes(x = Dim1, y = Dim2, color = `2PT FG`, size = `3PT FG`, label = Player)) +
  geom_point(alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  scale_color_gradient(low = "lightblue", high = "darkblue") +
  labs(title = "MDS (Euclidean distance): 2PT (color) and 3PT (size)",
       x = "Coordinate 1", y = "Coordinate 2", color = "2PT FG", size = "3PT FG") +
  theme_minimal()

ggplot(mds_gw_coords, aes(x = Dim1, y = Dim2, color = `2PT FG`, size = `3PT FG`, label = Player)) +
  geom_point(alpha = 0.8) +
  geom_text_repel(size = 3, max.overlaps = 25) +
  scale_color_gradient(low = "lightblue", high = "darkblue") +
  labs(title = "MDS (Gower distance): 2PT (color) and 3PT (size)",
       x = "Coordinate 1", y = "Coordinate 2", color = "2PT FG", size = "3PT FG") +
  theme_minimal()
```

## Which MDS do you think better group the individuals? Why?

First of all, it is worth noting that the goodness-of-fit (GOF) of both MDS solutions is very similar. Therefore, when deciding which of the two better groups the individuals, we considered other aspects, such as analyzing the plots to see which clusters can be formed based on the variables in the data frame.

Overall, both MDS methods provide a correct mapping of the individuals when considering overall performance statistics. The Euclidean MDS may cluster individuals slightly better when looking at efficiency or points scored, but the Gower MDS also produces meaningful clusters for these variables.

However, when taking into account the players’ positions, the Gower map clearly defines the clusters much better, as it incorporates this categorical variable. In contrast, the Euclidean map does not account for position, so the clustering is less precise in this regard.

Since the players’ positions are key in determining their statistics, as shown by the PCA, it is important that this variable is considered when forming clusters.

For this reason, we conclude that the Gower MDS produces groups that feel more realistic from a basketball perspective, capturing both their performance statistics and their roles on the court.

# Application of MCA

## Convert the numerical variables to binary variables with two categories as “over average” and “below average” performances
A function has been created to convert the numerical variables into binary variables. Consequently, a new data frame called *df_binary* has been generated. After the categorization of the numerical variables, all variables in this new data frame are categorical, which makes it suitable for applying MCA.

```{r}
df_binary <- df_subset

binary <- function(x){
  ifelse(x > mean(x), "over_average", "below_average")
}

for(col in names(df_subset[,-1])) {
  df_binary[[col]] <- as.factor(binary(df_subset[[col]]))
}

summary(df_binary)
```


## Apply MCA on these variables and interpret your findings
The *MCA* function from the *FactoMineR* library has been applied to the *df_binary*.

Note that the maximum number of dimensions is defined as $\min(n_{\text{obs}} - 1, K - J)$, where $ K $ is the total number of categories ($2 \cdot 15 + 3 = 33$) and $J$ is the total number of categorical variables ($16$). Therefore, the maximum number of dimensions is $33 - 16 = 17$.

The average inertia per dimension is $\text{avg} = \frac{1}{K - J} = \frac{1}{17}$. Hence, the dimensions that should be retained are those whose eigenvalues are greater than the average inertia; in other words, those satisfying $\lambda_i > \frac{1}{17}$.

After plotting a bar plot of the eigenvalues with a horizontal red line at $h = \frac{1}{17}$, it can be observed that the dimensions to be retained are dimensions $1$, $2$ and $3$. Dimension $4$ lies on the threshold, as its eigenvalue is approximately equal to the average inertia.

In order to determine which categories contribute the most to each of the relevant dimensions, two complementary strategies have been applied. On the one hand, categories with higher $cos^2$ values in a given dimension are considered to contribute more strongly to that dimension. On the other hand, by examining the category cloud plots, we can visually observe how the dimensions separate the categories and which variables are most influential in defining the corresponding axes.

Dimension $1$ is clearly defined by the efficiency of a player. Other variables, such as the minutes played, points scored, number of rebounds, and turnovers, also contribute to shaping this dimension. Therefore, Dimension $1$ can be interpreted as the overall performance and productivity axis.

Moreover, considering the coordinates of the different categories, Dimension $1$ clearly separates the below_average categories from the over_average ones. The plot shows that all below_average categories are located on the left, whereas the over_average categories are on the right.

By examining the players’ positions in the graph, it becomes evident which players perform best and worst overall. Those positioned toward the right side of the first dimension, such as Alperen Şengün, Giannis Antetokounmpo, Mikael Jantunen, Lauri Markkanen and Isaac Bonga, are over_average in the majority of performance-related categories. On the other hand, those on the left side of the first dimension, such as Leon Kratzer, Sertac Sanli, Andre Gustavson, Ilari Seppala and Omer Faruk Yurtseven, are below_average in the majority of performance-related categories.

Dimension $2$ is clearly defined by the player’s position. Other variables, such as 2PT and 3PT field goal percentages, overall field goal percentage, offensive rebounds, and blocks, also contribute to shaping this dimension. Therefore, Dimension $2$ can be interpreted as an interior vs perimeter playing style axis.

Moreover, considering the coordinates of the different categories, Dimension $2$ clearly separates the interior players (Centers and Forwards) from the exterior players (Guards).

Considering the coordinates of the different categories, the following patterns can be described for the main statistics:
- Center players tend to have over average values in variables such as 2PT.FG, FG and BLK, since they usually take shots close to the basket and tend to block the rivals shootings. Conversely, they tend to have below average values in 3PT.FG, as they rarely attempt long-distance shots.
- Forward players tend to commit more personal fouls and grab more offensive rebounds, as their role often involves defending opponents and fighting for rebounds under the basket.
- Guard players tend to have over average values in 3PT.FG, as they are typically responsible for taking shots from beyond the arc. On the other hand, their 2PT.FG and FG percentages are generally below average, since their shot attempts are usually made from longer distances and are therefore more difficult. Moreover, the number of offensive rebounds is also very low, since they tend to play far from the rivals basket.

By examining the players’ positions in the graph, as it it expected, each player is close to their position.

Dimension $3$ is also clearly defined by the players’ positions. Other variables, such as 3PT field goal percentage, free throws, number of assists, and personal fouls, also contribute to shaping this dimension. However, since the variance explained by this axis is considerably smaller, it is not as informative as the first two dimensions. This is expected, as the bar plot of the eigenvalues clearly shows that Dimensions $1$ and $2$ are the ones that best describe the variability in the data. In fact, when the third dimension is plotted, the vast majority of categories form a cluster in the center of the graphic. Hence, it is difficult to interpret this dimension.

It is important to note that the first and second dimensions of the PCA are closely related to the first and second dimensions of the MCA, as both capture similar underlying patterns in player performance — the first dimension representing overall workload and impact, and the second reflecting the contrast between interior and perimeter playing styles.

```{r}
res.mca <- MCA(df_binary)

res.mca$eig
barplot(res.mca$eig[,1], main="Eigenvalues", names.arg=1:nrow(res.mca$eig))
abline(h = 1/17, col = "red")

res.mca$var$coord

res.mca$var
dimdesc(res.mca)


plot(res.mca,choix="var",title="Graph of the variables dim 1 vs 2")
plot(res.mca,choix="var",axes=c(2,3),title="Graph of the variables dim 2 vs 3")

# Exploring dimension 1

plot(res.mca,invisible=c("ind"),col.var=c(c("blue", "deepskyblue", "lightblue"), rep(c("black", "red"), 15)),title="Graph of the over/below average performance")

plot(res.mca,col.ind="green",col.var=c(c("blue", "deepskyblue", "lightblue"), rep(c("black", "red"), 15)),title="Graph of the over/below average performance with individuals")

sort(res.mca$ind$coord[, 1], decreasing = TRUE)[1:5]
sort(res.mca$ind$coord[, 1], decreasing = FALSE)[1:5]

# Exploring dimension 2

plot(res.mca,invisible=c("ind"),col.var=c(c("blue", "purple", "red"), rep("black",30)),title="Graph of the playing style performance")

plot(res.mca,col.ind="green",col.var=c(c("blue", "purple", "red"), rep("black",30)),title="Graph of the playing style performance with individuals")

# Exploring dimension 3

plot(res.mca,invisible=c("ind"),col.var=c(c("blue", "purple", "red"), rep("black",30)),axes=c(2,3),title="Graph of the playing style performance")

plot(res.mca,col.ind="green",col.var=c(c("blue", "purple", "red"), rep("black",30)),axes=c(1,3),title="Graph of the playing style performance")
```

Moreover, taking Efficiency as a supplementary variable is also coherent with the approach used in the PCA, where it was not included in the main analysis. Interestingly, both methods (PCA and MCA) show very similar structures, suggesting that the categorical representation obtained from the MCA is consistent with the quantitative relationships revealed by the PCA.

In this case, since there are $14$ binary categories, the maximum number of dimensions is $14$. Following the same reasoning as before, the relevant dimensions are $1$ and $2$.

These additional MCA results do not provide substantially new insights compared to the previous analysis. Instead, they confirm the same general patterns observed before: Dimension $1$ mainly reflects overall player performance (distinguishing between below and over average players), while Dimension $2$ captures differences in shooting profiles, separating players who rely more on close-range shots from those who focus on three-point attempts.

In fact, it can be observed that Dimension $1$ is highly positively correlated with the supplementary quantitative variable EFF, whereas Dimension $2$ is clearly influenced by the supplementary qualitative variable Position, consistent with what was observed in the PCA results.

```{r}
# Position as a suplementary variable
df_binary$EFF <- NULL
df_binary$EFF <- df_subset$EFF
res.mca.extra <- MCA(df_binary, quali.sup=1, quanti.sup = 16)

summary(res.mca.extra)

barplot(res.mca.extra$eig[,1], main="Eigenvalues extra MCA", names.arg=1:nrow(res.mca.extra$eig))
abline(h = 1/14, col = "red")

res.mca.extra$var$coord

res.mca.extra$var

plot(res.mca.extra,invisible=c("ind"),col.var=c(rep(c("blue", "red"), 15)),title="Graph of the over/below average performance of the extra MCA")
```










